<!DOCTYPE html>
<html lang="ar" dir="rtl">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>ğŸ”„ Ø§Ø®ØªØ¨Ø§Ø± ØªØ¯ÙÙ‚ Ø§Ù„Ù‚Ø±Ø§Ø±Ø§Øª Ø§Ù„Ø­Ù‚ÙŠÙ‚ÙŠØ©</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }
        
        body {
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            min-height: 100vh;
            padding: 20px;
        }
        
        .container {
            max-width: 1200px;
            margin: 0 auto;
            background: white;
            border-radius: 20px;
            box-shadow: 0 20px 40px rgba(0,0,0,0.1);
            overflow: hidden;
        }
        
        .header {
            background: linear-gradient(135deg, #4f46e5 0%, #7c3aed 100%);
            color: white;
            padding: 30px;
            text-align: center;
        }
        
        .content {
            padding: 30px;
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 30px;
        }
        
        .section {
            background: #f8fafc;
            border-radius: 15px;
            padding: 25px;
            border-left: 5px solid #4f46e5;
        }
        
        .section h2 {
            color: #1e293b;
            margin-bottom: 20px;
            font-size: 1.5rem;
            display: flex;
            align-items: center;
            gap: 10px;
        }
        
        .form-group {
            margin-bottom: 15px;
        }
        
        .form-group label {
            display: block;
            margin-bottom: 5px;
            font-weight: 600;
            color: #374151;
        }
        
        .form-group input, .form-group select, .form-group textarea {
            width: 100%;
            padding: 10px;
            border: 2px solid #e2e8f0;
            border-radius: 8px;
            font-size: 14px;
        }
        
        .btn {
            background: linear-gradient(135deg, #4f46e5 0%, #7c3aed 100%);
            color: white;
            border: none;
            padding: 12px 24px;
            border-radius: 8px;
            cursor: pointer;
            font-weight: 600;
            margin: 5px;
            transition: transform 0.2s;
        }
        
        .btn:hover {
            transform: translateY(-2px);
        }
        
        .btn-success { background: linear-gradient(135deg, #10b981 0%, #059669 100%); }
        .btn-danger { background: linear-gradient(135deg, #ef4444 0%, #dc2626 100%); }
        .btn-info { background: linear-gradient(135deg, #3b82f6 0%, #2563eb 100%); }
        
        .decision {
            background: white;
            border: 2px solid #e2e8f0;
            border-radius: 10px;
            padding: 15px;
            margin: 10px 0;
        }
        
        .decision-success {
            border-left: 4px solid #10b981;
            background: #f0fdf4;
        }
        
        .decision-error {
            border-left: 4px solid #ef4444;
            background: #fef2f2;
        }
        
        .results {
            background: #1e293b;
            color: #e2e8f0;
            padding: 20px;
            border-radius: 10px;
            font-family: 'Courier New', monospace;
            font-size: 14px;
            max-height: 400px;
            overflow-y: auto;
            white-space: pre-wrap;
            grid-column: 1 / -1;
        }
        
        .status-indicator {
            display: inline-block;
            width: 10px;
            height: 10px;
            border-radius: 50%;
            margin-left: 5px;
        }
        
        .status-online { background: #10b981; }
        .status-offline { background: #ef4444; }
        
        .highlight {
            background: #fef3c7;
            padding: 15px;
            border-radius: 10px;
            border-left: 4px solid #f59e0b;
            margin: 15px 0;
        }
    </style>
</head>
<body>
    <div class="container">
        <div class="header">
            <h1>ğŸ”„ Ø§Ø®ØªØ¨Ø§Ø± ØªØ¯ÙÙ‚ Ø§Ù„Ù‚Ø±Ø§Ø±Ø§Øª Ø§Ù„Ø­Ù‚ÙŠÙ‚ÙŠØ©</h1>
            <p>Ù…Ù† Admin Panel Ø¥Ù„Ù‰ Espace Freelancer Ù…Ø¨Ø§Ø´Ø±Ø©</p>
            <div class="highlight">
                <strong>ğŸ¯ Ø§Ù„Ù‡Ø¯Ù:</strong> Ø§Ù„ØªØ£ÙƒØ¯ Ù…Ù† Ø£Ù† Ø§Ù„Ù‚Ø±Ø§Ø±Ø§Øª Ø§Ù„Ù…Ø±Ø³Ù„Ø© Ù…Ù† Admin Panel ØªØ¸Ù‡Ø± ÙÙŠ Espace Freelancer Ù„Ù„ÙØ±ÙŠÙ„Ø§Ù†Ø³Ø± Ø§Ù„ØµØ­ÙŠØ­
            </div>
        </div>
        
        <div class="content">
            <!-- Admin Panel Simulation -->
            <div class="section">
                <h2>ğŸ¢ Admin Panel - Ø¥Ø±Ø³Ø§Ù„ Ù‚Ø±Ø§Ø±</h2>
                <div class="form-group">
                    <label>Ø§Ù„ÙØ±ÙŠÙ„Ø§Ù†Ø³Ø± Ø§Ù„Ù…Ø³ØªÙ‡Ø¯Ù:</label>
                    <select id="targetFreelancer">
                        <option value="FRE-340255">FRE-340255 (ismail)</option>
                        <option value="FRE-269251">FRE-269251 (azmd)</option>
                        <option value="FRE-123456">FRE-123456 (test)</option>
                    </select>
                </div>
                <div class="form-group">
                    <label>Ø¹Ù†ÙˆØ§Ù† Ø§Ù„Ù€ Livrable:</label>
                    <input type="text" id="deliverableTitle" value="Design Interface Utilisateur" placeholder="Ø¹Ù†ÙˆØ§Ù† Ø§Ù„Ù€ Livrable">
                </div>
                <div class="form-group">
                    <label>Ø§Ù„Ù‚Ø±Ø§Ø±:</label>
                    <select id="decision">
                        <option value="approved">âœ… Ù…Ù‚Ø¨ÙˆÙ„ (AcceptÃ©)</option>
                        <option value="rejected">âŒ Ù…Ø±ÙÙˆØ¶ (RefusÃ©)</option>
                    </select>
                </div>
                <div class="form-group">
                    <label>Ù…Ù„Ø§Ø­Ø¸Ø§Øª Ø§Ù„Ø¥Ø¯Ø§Ø±Ø©:</label>
                    <textarea id="observation" rows="3" placeholder="Ù…Ù„Ø§Ø­Ø¸Ø§Øª ÙˆØªØ¹Ù„ÙŠÙ‚Ø§Øª Ø§Ù„Ø¥Ø¯Ø§Ø±Ø©...">Ø¹Ù…Ù„ Ù…Ù…ØªØ§Ø²! Ø§Ù„ØªØµÙ…ÙŠÙ… ÙŠÙ„Ø¨ÙŠ Ø¬Ù…ÙŠØ¹ Ø§Ù„Ù…ØªØ·Ù„Ø¨Ø§Øª Ø§Ù„Ù…Ø·Ù„ÙˆØ¨Ø©.</textarea>
                </div>
                <button class="btn" onclick="sendRealDecision()">ğŸ“¤ Ø¥Ø±Ø³Ø§Ù„ Ø§Ù„Ù‚Ø±Ø§Ø± Ø§Ù„Ø­Ù‚ÙŠÙ‚ÙŠ</button>
                <button class="btn btn-info" onclick="checkBackendStatus()">ğŸ” ÙØ­Øµ Backend</button>
                
                <div id="adminStatus" style="margin-top: 15px; padding: 10px; border-radius: 5px; background: #f3f4f6;">
                    <strong>Ø­Ø§Ù„Ø© Ø§Ù„Ø¥Ø±Ø³Ø§Ù„:</strong> <span id="sendStatus">Ø¬Ø§Ù‡Ø² Ù„Ù„Ø¥Ø±Ø³Ø§Ù„</span>
                </div>
            </div>
            
            <!-- Espace Freelancer Simulation -->
            <div class="section">
                <h2>ğŸ‘¤ Espace Freelancer - Ø§Ø³ØªÙ‚Ø¨Ø§Ù„ Ø§Ù„Ù‚Ø±Ø§Ø±</h2>
                <div class="form-group">
                    <label>ØªØ³Ø¬ÙŠÙ„ Ø¯Ø®ÙˆÙ„ ÙƒÙ€:</label>
                    <select id="loginFreelancer">
                        <option value="FRE-340255">FRE-340255 (ismail)</option>
                        <option value="FRE-269251">FRE-269251 (azmd)</option>
                        <option value="FRE-123456">FRE-123456 (test)</option>
                    </select>
                </div>
                <button class="btn btn-success" onclick="checkFreelancerDecisions()">ğŸ“¬ ÙØ­Øµ Ø§Ù„Ù‚Ø±Ø§Ø±Ø§Øª Ø§Ù„Ù…Ø³ØªÙ„Ù…Ø©</button>
                <button class="btn btn-info" onclick="simulateFreelancerLogin()">ğŸ”‘ Ù…Ø­Ø§ÙƒØ§Ø© ØªØ³Ø¬ÙŠÙ„ Ø§Ù„Ø¯Ø®ÙˆÙ„</button>
                <button class="btn btn-danger" onclick="clearFreelancerData()">ğŸ—‘ï¸ Ù…Ø³Ø­ Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª</button>
                
                <div id="freelancerStatus" style="margin-top: 15px; padding: 10px; border-radius: 5px; background: #f3f4f6;">
                    <strong>Ø­Ø§Ù„Ø© Ø§Ù„Ø§Ø³ØªÙ‚Ø¨Ø§Ù„:</strong> <span id="receiveStatus">ÙÙŠ Ø§Ù†ØªØ¸Ø§Ø± Ø§Ù„Ù‚Ø±Ø§Ø±Ø§Øª</span>
                </div>
                
                <div id="decisionsDisplay" style="margin-top: 15px;">
                    <!-- Ø³ÙŠØªÙ… Ø¹Ø±Ø¶ Ø§Ù„Ù‚Ø±Ø§Ø±Ø§Øª Ù‡Ù†Ø§ -->
                </div>
            </div>
            
            <!-- Results Log -->
            <div class="section">
                <h2>ğŸ“Š Ø³Ø¬Ù„ Ø§Ù„Ø¹Ù…Ù„ÙŠØ§Øª ÙˆØ§Ù„Ù†ØªØ§Ø¦Ø¬</h2>
                <div class="results" id="results">ğŸš€ Ø¨Ø¯Ø¡ Ø§Ø®ØªØ¨Ø§Ø± ØªØ¯ÙÙ‚ Ø§Ù„Ù‚Ø±Ø§Ø±Ø§Øª Ø§Ù„Ø­Ù‚ÙŠÙ‚ÙŠØ©...\n</div>
            </div>
        </div>
    </div>

    <script>
        let backendAvailable = false;

        // ØªØ³Ø¬ÙŠÙ„ Ø§Ù„Ù†ØªØ§Ø¦Ø¬
        function log(message) {
            const results = document.getElementById('results');
            const timestamp = new Date().toLocaleTimeString('ar-SA');
            results.textContent += `[${timestamp}] ${message}\n`;
            results.scrollTop = results.scrollHeight;
            console.log(message);
        }

        // ÙØ­Øµ Ø­Ø§Ù„Ø© Backend
        async function checkBackendStatus() {
            try {
                log('ğŸ” ÙØ­Øµ Ø­Ø§Ù„Ø© Backend API...');
                const response = await fetch('http://localhost:3001/api/freelancer-decisions/FRE-123456');
                
                if (response.ok) {
                    backendAvailable = true;
                    document.getElementById('sendStatus').innerHTML = 'âœ… Backend Ù…ØªØµÙ„ - Ø¬Ø§Ù‡Ø² Ù„Ù„Ø¥Ø±Ø³Ø§Ù„';
                    log('âœ… Backend API Ù…ØªØ§Ø­ ÙˆÙŠØ¹Ù…Ù„ Ø¨Ø´ÙƒÙ„ ØµØ­ÙŠØ­');
                } else {
                    throw new Error(`HTTP ${response.status}`);
                }
            } catch (error) {
                backendAvailable = false;
                document.getElementById('sendStatus').innerHTML = 'âŒ Backend ØºÙŠØ± Ù…ØªØµÙ„ - Ø³ÙŠØªÙ… Ø§Ø³ØªØ®Ø¯Ø§Ù… localStorage';
                log(`âŒ Backend API ØºÙŠØ± Ù…ØªØ§Ø­: ${error.message}`);
                log('ğŸ’¾ Ø³ÙŠØªÙ… Ø§Ø³ØªØ®Ø¯Ø§Ù… localStorage ÙƒÙ€ fallback');
            }
        }

        // Ø¥Ø±Ø³Ø§Ù„ Ù‚Ø±Ø§Ø± Ø­Ù‚ÙŠÙ‚ÙŠ
        async function sendRealDecision() {
            const freelancerId = document.getElementById('targetFreelancer').value;
            const freelancerName = freelancerId === 'FRE-340255' ? 'ismail' : 
                                 freelancerId === 'FRE-269251' ? 'azmd' : 'test';
            const deliverableTitle = document.getElementById('deliverableTitle').value;
            const decision = document.getElementById('decision').value;
            const observation = document.getElementById('observation').value;

            if (!deliverableTitle.trim()) {
                alert('ÙŠØ±Ø¬Ù‰ Ø¥Ø¯Ø®Ø§Ù„ Ø¹Ù†ÙˆØ§Ù† Ø§Ù„Ù€ Livrable');
                return;
            }

            try {
                log(`ğŸ“¤ Ø¥Ø±Ø³Ø§Ù„ Ù‚Ø±Ø§Ø± "${decision}" Ù„Ù„ÙØ±ÙŠÙ„Ø§Ù†Ø³Ø± ${freelancerId}...`);
                document.getElementById('sendStatus').innerHTML = 'ğŸ”„ Ø¬Ø§Ø±ÙŠ Ø§Ù„Ø¥Ø±Ø³Ø§Ù„...';
                
                let success = false;
                
                // Ù…Ø­Ø§ÙˆÙ„Ø© Ø§Ù„Ø¥Ø±Ø³Ø§Ù„ Ø¹Ø¨Ø± Backend API Ø£ÙˆÙ„Ø§Ù‹
                if (backendAvailable) {
                    try {
                        const response = await fetch('http://localhost:3001/api/freelancer-decisions', {
                            method: 'POST',
                            headers: { 'Content-Type': 'application/json' },
                            body: JSON.stringify({
                                freelancerId,
                                freelancerName,
                                deliverableTitle,
                                decision,
                                observation,
                                adminId: 'admin'
                            })
                        });

                        if (response.ok) {
                            const result = await response.json();
                            log(`âœ… ØªÙ… Ø¥Ø±Ø³Ø§Ù„ Ø§Ù„Ù‚Ø±Ø§Ø± Ø¨Ù†Ø¬Ø§Ø­ Ø¹Ø¨Ø± Backend API: ${result.data._id}`);
                            document.getElementById('sendStatus').innerHTML = 'âœ… ØªÙ… Ø§Ù„Ø¥Ø±Ø³Ø§Ù„ Ø¹Ø¨Ø± Backend API';
                            success = true;
                        } else {
                            throw new Error(`HTTP ${response.status}`);
                        }
                    } catch (apiError) {
                        log(`âš ï¸ ÙØ´Ù„ Ø§Ù„Ø¥Ø±Ø³Ø§Ù„ Ø¹Ø¨Ø± API: ${apiError.message}`);
                    }
                }
                
                // Fallback Ø¥Ù„Ù‰ localStorage
                if (!success) {
                    log('ğŸ’¾ Ø§Ù„ØªØ¨Ø¯ÙŠÙ„ Ø¥Ù„Ù‰ localStorage...');
                    
                    const localDecision = {
                        _id: `local-${Date.now()}`,
                        freelancerId,
                        freelancerName,
                        deliverableTitle,
                        decision,
                        observation,
                        adminId: 'admin',
                        status: 'sent',
                        readAt: null,
                        createdAt: new Date().toISOString(),
                        updatedAt: new Date().toISOString()
                    };

                    // Ø­ÙØ¸ ÙÙŠ localStorage Ù„Ù„Ù†Ø¸Ø§Ù… Ø§Ù„Ø¬Ø¯ÙŠØ¯
                    const newKey = `freelancerDecisions_${freelancerId}`;
                    const existingDecisions = JSON.parse(localStorage.getItem(newKey) || '[]');
                    existingDecisions.unshift(localDecision);
                    localStorage.setItem(newKey, JSON.stringify(existingDecisions));

                    // Ø­ÙØ¸ ÙÙŠ localStorage Ù„Ù„Ù†Ø¸Ø§Ù… Ø§Ù„Ù‚Ø¯ÙŠÙ… (Ù„Ù„ØªÙˆØ§ÙÙ‚)
                    const oldKey = `freelancerNotifications_${freelancerId}`;
                    const oldNotifications = JSON.parse(localStorage.getItem(oldKey) || '[]');
                    const oldNotification = {
                        id: `notif-${Date.now()}`,
                        freelancerId,
                        freelancerName,
                        type: decision === 'approved' ? 'success' : 'error',
                        title: decision === 'approved' ? 'âœ… Livrable AcceptÃ©' : 'âŒ Livrable RefusÃ©',
                        message: `Titre: ${deliverableTitle}\nStatut: ${decision === 'approved' ? 'AcceptÃ©' : 'RefusÃ©'}\nObservation: ${observation}`,
                        deliverableName: deliverableTitle,
                        decision: decision,
                        observation: observation,
                        timestamp: new Date().toISOString(),
                        read: false,
                        from: 'admin'
                    };
                    oldNotifications.unshift(oldNotification);
                    localStorage.setItem(oldKey, JSON.stringify(oldNotifications));

                    log(`ğŸ’¾ ØªÙ… Ø­ÙØ¸ Ø§Ù„Ù‚Ø±Ø§Ø± ÙÙŠ localStorage Ù„Ù„ÙØ±ÙŠÙ„Ø§Ù†Ø³Ø± ${freelancerId}`);
                    document.getElementById('sendStatus').innerHTML = 'ğŸ’¾ ØªÙ… Ø§Ù„Ø­ÙØ¸ ÙÙŠ localStorage';
                    success = true;
                }

                if (success) {
                    log(`ğŸ¯ Ø§Ù„Ù‚Ø±Ø§Ø± Ø¬Ø§Ù‡Ø² Ù„Ù„Ø¹Ø±Ø¶ ÙÙŠ Espace Freelancer Ù„Ù„ÙØ±ÙŠÙ„Ø§Ù†Ø³Ø± ${freelancerId}`);
                    
                    // ØªØ­Ø¯ÙŠØ« Ø¹Ø±Ø¶ Ø§Ù„ÙØ±ÙŠÙ„Ø§Ù†Ø³Ø± Ø¥Ø°Ø§ ÙƒØ§Ù† Ù†ÙØ³ Ø§Ù„Ø´Ø®Øµ
                    const loginId = document.getElementById('loginFreelancer').value;
                    if (loginId === freelancerId) {
                        setTimeout(() => {
                            checkFreelancerDecisions();
                        }, 1000);
                    }
                }

            } catch (error) {
                log(`âŒ Ø®Ø·Ø£ ÙÙŠ Ø¥Ø±Ø³Ø§Ù„ Ø§Ù„Ù‚Ø±Ø§Ø±: ${error.message}`);
                document.getElementById('sendStatus').innerHTML = 'âŒ ÙØ´Ù„ ÙÙŠ Ø§Ù„Ø¥Ø±Ø³Ø§Ù„';
            }
        }

        // ÙØ­Øµ Ù‚Ø±Ø§Ø±Ø§Øª Ø§Ù„ÙØ±ÙŠÙ„Ø§Ù†Ø³Ø±
        async function checkFreelancerDecisions() {
            const freelancerId = document.getElementById('loginFreelancer').value;
            
            try {
                log(`ğŸ“¬ ÙØ­Øµ Ø§Ù„Ù‚Ø±Ø§Ø±Ø§Øª Ù„Ù„ÙØ±ÙŠÙ„Ø§Ù†Ø³Ø± ${freelancerId}...`);
                document.getElementById('receiveStatus').innerHTML = 'ğŸ”„ Ø¬Ø§Ø±ÙŠ Ø§Ù„ÙØ­Øµ...';
                
                let decisions = [];
                
                // Ù…Ø­Ø§ÙˆÙ„Ø© Ø¬Ù„Ø¨ Ù…Ù† Backend API
                if (backendAvailable) {
                    try {
                        const response = await fetch(`http://localhost:3001/api/freelancer-decisions/${freelancerId}`);
                        if (response.ok) {
                            const result = await response.json();
                            decisions = result.data || [];
                            log(`âœ… ØªÙ… Ø¬Ù„Ø¨ ${decisions.length} Ù‚Ø±Ø§Ø± Ù…Ù† Backend API`);
                        }
                    } catch (apiError) {
                        log(`âš ï¸ ÙØ´Ù„ Ø¬Ù„Ø¨ Ù…Ù† API: ${apiError.message}`);
                    }
                }
                
                // Ø¬Ù„Ø¨ Ù…Ù† localStorage
                const localKey = `freelancerDecisions_${freelancerId}`;
                const localDecisions = JSON.parse(localStorage.getItem(localKey) || '[]');
                
                if (localDecisions.length > 0) {
                    log(`ğŸ’¾ ØªÙ… Ø¬Ù„Ø¨ ${localDecisions.length} Ù‚Ø±Ø§Ø± Ù…Ù† localStorage`);
                    // Ø¯Ù…Ø¬ Ø§Ù„Ù‚Ø±Ø§Ø±Ø§Øª
                    const allDecisions = [...decisions, ...localDecisions];
                    const uniqueDecisions = allDecisions.filter((decision, index, self) => 
                        index === self.findIndex(d => d._id === decision._id)
                    );
                    decisions = uniqueDecisions;
                }
                
                displayDecisions(decisions);
                
                if (decisions.length > 0) {
                    document.getElementById('receiveStatus').innerHTML = `âœ… ØªÙ… Ø§Ù„Ø¹Ø«ÙˆØ± Ø¹Ù„Ù‰ ${decisions.length} Ù‚Ø±Ø§Ø±`;
                    log(`ğŸ‰ ØªÙ… Ø§Ù„Ø¹Ø«ÙˆØ± Ø¹Ù„Ù‰ ${decisions.length} Ù‚Ø±Ø§Ø± Ù„Ù„ÙØ±ÙŠÙ„Ø§Ù†Ø³Ø± ${freelancerId}`);
                } else {
                    document.getElementById('receiveStatus').innerHTML = 'ğŸ“­ Ù„Ø§ ØªÙˆØ¬Ø¯ Ù‚Ø±Ø§Ø±Ø§Øª';
                    log(`ğŸ“­ Ù„Ø§ ØªÙˆØ¬Ø¯ Ù‚Ø±Ø§Ø±Ø§Øª Ù„Ù„ÙØ±ÙŠÙ„Ø§Ù†Ø³Ø± ${freelancerId}`);
                }
                
            } catch (error) {
                log(`âŒ Ø®Ø·Ø£ ÙÙŠ ÙØ­Øµ Ø§Ù„Ù‚Ø±Ø§Ø±Ø§Øª: ${error.message}`);
                document.getElementById('receiveStatus').innerHTML = 'âŒ Ø®Ø·Ø£ ÙÙŠ Ø§Ù„ÙØ­Øµ';
            }
        }

        // Ø¹Ø±Ø¶ Ø§Ù„Ù‚Ø±Ø§Ø±Ø§Øª
        function displayDecisions(decisions) {
            const container = document.getElementById('decisionsDisplay');
            
            if (decisions.length === 0) {
                container.innerHTML = `
                    <div class="decision">
                        <h4>ğŸ“­ Ù„Ø§ ØªÙˆØ¬Ø¯ Ù‚Ø±Ø§Ø±Ø§Øª</h4>
                        <p>Ù„Ù… ÙŠØªÙ… Ø§Ø³ØªÙ„Ø§Ù… Ø£ÙŠ Ù‚Ø±Ø§Ø±Ø§Øª Ù…Ù† Ø§Ù„Ø¥Ø¯Ø§Ø±Ø© Ø¨Ø¹Ø¯.</p>
                    </div>
                `;
                return;
            }
            
            container.innerHTML = `
                <h3 style="margin-bottom: 15px;">ğŸ“‹ Ø§Ù„Ù‚Ø±Ø§Ø±Ø§Øª Ø§Ù„Ù…Ø³ØªÙ„Ù…Ø© (${decisions.length}):</h3>
                ${decisions.map(decision => `
                    <div class="decision ${decision.decision === 'approved' ? 'decision-success' : 'decision-error'}">
                        <div style="display: flex; justify-content: between; align-items: start;">
                            <div style="flex: 1;">
                                <h4>${decision.decision === 'approved' ? 'âœ… Livrable AcceptÃ©' : 'âŒ Livrable RefusÃ©'} 
                                    ${decision.status === 'sent' ? 'ğŸ”´ Ø¬Ø¯ÙŠØ¯' : 'ğŸ‘ï¸ Ù…Ù‚Ø±ÙˆØ¡'}</h4>
                                <p><strong>Livrable:</strong> ${decision.deliverableTitle}</p>
                                <p><strong>DÃ©cision:</strong> ${decision.decision === 'approved' ? 'AcceptÃ©' : 'RefusÃ©'}</p>
                                ${decision.observation ? `<p><strong>Observation:</strong> ${decision.observation}</p>` : ''}
                                <small style="color: #6b7280;">
                                    ğŸ“… ${new Date(decision.createdAt).toLocaleString('ar-SA')} | 
                                    ğŸ‘¤ De: ${decision.adminId} |
                                    ğŸ†” ${decision._id.startsWith('local-') ? 'localStorage' : 'Backend API'}
                                </small>
                            </div>
                        </div>
                    </div>
                `).join('')}
            `;
        }

        // Ù…Ø­Ø§ÙƒØ§Ø© ØªØ³Ø¬ÙŠÙ„ Ø¯Ø®ÙˆÙ„ Ø§Ù„ÙØ±ÙŠÙ„Ø§Ù†Ø³Ø±
        function simulateFreelancerLogin() {
            const freelancerId = document.getElementById('loginFreelancer').value;
            
            // Ù…Ø­Ø§ÙƒØ§Ø© session
            const session = {
                freelancerId: freelancerId,
                isAuthenticated: true,
                loginTime: new Date().toISOString()
            };
            
            localStorage.setItem('freelancerSession', JSON.stringify(session));
            log(`ğŸ”‘ ØªÙ… ØªØ³Ø¬ÙŠÙ„ Ø¯Ø®ÙˆÙ„ Ø§Ù„ÙØ±ÙŠÙ„Ø§Ù†Ø³Ø± ${freelancerId}`);
            
            // ÙØ­Øµ Ø§Ù„Ù‚Ø±Ø§Ø±Ø§Øª ØªÙ„Ù‚Ø§Ø¦ÙŠØ§Ù‹
            setTimeout(checkFreelancerDecisions, 500);
        }

        // Ù…Ø³Ø­ Ø¨ÙŠØ§Ù†Ø§Øª Ø§Ù„ÙØ±ÙŠÙ„Ø§Ù†Ø³Ø±
        function clearFreelancerData() {
            const freelancerId = document.getElementById('loginFreelancer').value;
            
            if (confirm(`Ù‡Ù„ Ø£Ù†Øª Ù…ØªØ£ÙƒØ¯ Ù…Ù† Ø­Ø°Ù Ø¬Ù…ÙŠØ¹ Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª Ù„Ù„ÙØ±ÙŠÙ„Ø§Ù†Ø³Ø± ${freelancerId}ØŸ`)) {
                // Ø­Ø°Ù Ù…Ù† Ø§Ù„Ù†Ø¸Ø§Ù… Ø§Ù„Ø¬Ø¯ÙŠØ¯
                localStorage.removeItem(`freelancerDecisions_${freelancerId}`);
                // Ø­Ø°Ù Ù…Ù† Ø§Ù„Ù†Ø¸Ø§Ù… Ø§Ù„Ù‚Ø¯ÙŠÙ…
                localStorage.removeItem(`freelancerNotifications_${freelancerId}`);
                
                log(`ğŸ—‘ï¸ ØªÙ… Ø­Ø°Ù Ø¬Ù…ÙŠØ¹ Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª Ù„Ù„ÙØ±ÙŠÙ„Ø§Ù†Ø³Ø± ${freelancerId}`);
                document.getElementById('receiveStatus').innerHTML = 'ğŸ—‘ï¸ ØªÙ… Ø­Ø°Ù Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª';
                document.getElementById('decisionsDisplay').innerHTML = '';
            }
        }

        // ØªØ­Ù…ÙŠÙ„ Ø£ÙˆÙ„ÙŠ
        document.addEventListener('DOMContentLoaded', async function() {
            log('ğŸš€ Ø¨Ø¯Ø¡ Ø§Ø®ØªØ¨Ø§Ø± ØªØ¯ÙÙ‚ Ø§Ù„Ù‚Ø±Ø§Ø±Ø§Øª Ø§Ù„Ø­Ù‚ÙŠÙ‚ÙŠØ©');
            log('ğŸ” ÙØ­Øµ Ø­Ø§Ù„Ø© Backend...');
            
            await checkBackendStatus();
            
            log('âœ… Ø§Ù„Ù†Ø¸Ø§Ù… Ø¬Ø§Ù‡Ø² Ù„Ù„Ø§Ø®ØªØ¨Ø§Ø±');
            log('ğŸ“‹ Ø§Ù„Ø®Ø·ÙˆØ§Øª:');
            log('1. Ø§Ø®ØªØ± Ø§Ù„ÙØ±ÙŠÙ„Ø§Ù†Ø³Ø± Ø§Ù„Ù…Ø³ØªÙ‡Ø¯Ù ÙÙŠ Admin Panel');
            log('2. Ø£Ø¯Ø®Ù„ ØªÙØ§ØµÙŠÙ„ Ø§Ù„Ù‚Ø±Ø§Ø± ÙˆØ§Ø¶ØºØ· "Ø¥Ø±Ø³Ø§Ù„ Ø§Ù„Ù‚Ø±Ø§Ø± Ø§Ù„Ø­Ù‚ÙŠÙ‚ÙŠ"');
            log('3. Ø§Ø®ØªØ± Ù†ÙØ³ Ø§Ù„ÙØ±ÙŠÙ„Ø§Ù†Ø³Ø± ÙÙŠ Espace Freelancer');
            log('4. Ø§Ø¶ØºØ· "ÙØ­Øµ Ø§Ù„Ù‚Ø±Ø§Ø±Ø§Øª Ø§Ù„Ù…Ø³ØªÙ„Ù…Ø©" Ù„Ø±Ø¤ÙŠØ© Ø§Ù„Ù‚Ø±Ø§Ø±');
        });
    </script>
</body>
</html>
