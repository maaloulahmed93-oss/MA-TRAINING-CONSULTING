<!DOCTYPE html>
<html lang="fr">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Test Sessions Links - Progression du cours</title>
    <style>
        body { font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, sans-serif; margin: 0; padding: 20px; background: #f5f7fa; }
        .container { max-width: 1200px; margin: 0 auto; background: white; border-radius: 12px; box-shadow: 0 4px 6px rgba(0,0,0,0.1); overflow: hidden; }
        .header { background: linear-gradient(135deg, #667eea 0%, #764ba2 100%); color: white; padding: 30px; text-align: center; }
        .section { padding: 20px; border-bottom: 1px solid #e2e8f0; }
        .section:last-child { border-bottom: none; }
        .test-button { background: #4299e1; color: white; border: none; padding: 12px 24px; border-radius: 8px; cursor: pointer; margin: 5px; font-weight: 500; }
        .test-button:hover { background: #3182ce; }
        .test-button.success { background: #38a169; }
        .test-button.error { background: #e53e3e; }
        .result { background: #f7fafc; border: 1px solid #e2e8f0; border-radius: 8px; padding: 15px; margin: 10px 0; font-family: monospace; font-size: 12px; max-height: 300px; overflow-y: auto; }
        .success { background: #c6f6d5; border-color: #38a169; color: #22543d; }
        .error { background: #fed7d7; border-color: #e53e3e; color: #c53030; }
        .warning { background: #fef5e7; border-color: #d69e2e; color: #c05621; }
        .info { background: #bee3f8; border-color: #3182ce; color: #2c5282; }
        .grid { display: grid; grid-template-columns: 1fr 1fr; gap: 20px; }
        .card { background: #f8fafc; padding: 15px; border-radius: 8px; border: 1px solid #e2e8f0; }
        .session-demo { background: #f0f9ff; border: 2px solid #0ea5e9; border-radius: 8px; padding: 20px; margin: 15px 0; }
        .link-demo { background: #dbeafe; border: 1px solid #3b82f6; border-radius: 6px; padding: 12px; margin: 8px 0; display: flex; align-items: center; gap: 10px; }
        .link-icon { width: 32px; height: 32px; background: #3b82f6; border-radius: 6px; display: flex; align-items: center; justify-content: center; color: white; font-size: 14px; }
        .step { background: #f0fff4; border-left: 4px solid #38a169; padding: 15px; margin: 10px 0; }
    </style>
</head>
<body>
    <div class="container">
        <div class="header">
            <h1>üé• Test Sessions Links</h1>
            <p>V√©rification de l'affichage des liens de session dans "Progression du cours"</p>
        </div>

        <div class="section">
            <h2>üéØ Objectif</h2>
            <div class="info">
                <p><strong>Probl√®me:</strong> Les liens de session ajout√©s depuis l'Admin Panel n'apparaissent pas dans l'Espace Participant</p>
                <p><strong>Solution:</strong> Ajouter une section "Sessions du cours" qui affiche les liens de session</p>
                <p><strong>Localisation:</strong> Page "Progression du cours" ‚Üí Apr√®s la barre de progression</p>
            </div>
        </div>

        <div class="section">
            <h2>üîß Modifications Apport√©es</h2>
            
            <div class="step">
                <h3>1. Ajout des Types TypeScript</h3>
                <div class="card">
                    <h4>Nouveaux Interfaces</h4>
                    <pre style="font-size: 11px;">export interface SessionLink {
  id: string;
  title: string;
  url: string;
  type: string;
}

export interface Session {
  id: string;
  title: string;
  description?: string;
  duration: string;
  isCompleted: boolean;
  order?: number;
  links: SessionLink[];
}

// Course interface mise √† jour
export interface Course {
  // ... autres champs
  sessions?: Session[];  // ‚úÖ Nouveau
}</pre>
                </div>
            </div>

            <div class="step">
                <h3>2. Mise √† jour Transformation API</h3>
                <div class="card">
                    <h4>transformApiFormation Function</h4>
                    <pre style="font-size: 11px;">const transformApiFormation = (apiFormation: ApiFormation): Formation => {
  // Transform courses to include sessions
  const transformedCourses = (apiFormation.courses || []).map((course: any) => ({
    ...course,
    sessions: course.sessions || [] // ‚úÖ Ensure sessions are included
  }));

  return {
    // ... autres champs
    courses: transformedCourses,
  };
};</pre>
                </div>
            </div>

            <div class="step">
                <h3>3. Ajout Section Sessions UI</h3>
                <div class="card">
                    <h4>Nouvelle Section dans MesFormations.tsx</h4>
                    <pre style="font-size: 11px;">{/* Sessions List */}
{selectedCourse.sessions && selectedCourse.sessions.length > 0 && (
  &lt;div className="bg-white rounded-xl p-6 shadow-sm border mb-8"&gt;
    &lt;h2 className="text-lg font-semibold mb-4 flex items-center"&gt;
      &lt;Video className="w-5 h-5 mr-2 text-blue-600" /&gt;
      Sessions du cours
    &lt;/h2&gt;
    {/* Session cards with links */}
  &lt;/div&gt;
)}</pre>
                </div>
            </div>
        </div>

        <div class="section">
            <h2>üé® Aper√ßu Interface</h2>
            
            <div class="session-demo">
                <h3 style="margin: 0 0 15px 0; display: flex; align-items: center; gap: 8px;">
                    <span style="color: #3b82f6;">üé•</span>
                    Sessions du cours
                </h3>
                
                <div style="border: 1px solid #e5e7eb; border-radius: 8px; padding: 16px; margin-bottom: 16px;">
                    <div style="display: flex; justify-content: between; align-items: center; margin-bottom: 12px;">
                        <h4 style="margin: 0; font-weight: 500;">Session 1: Introduction au d√©veloppement</h4>
                        <span style="font-size: 12px; color: #6b7280;">2h30</span>
                    </div>
                    
                    <p style="font-size: 14px; color: #6b7280; margin-bottom: 12px;">
                        Cette session couvre les bases du d√©veloppement web moderne
                    </p>
                    
                    <div>
                        <h5 style="font-size: 14px; font-weight: 500; color: #374151; margin-bottom: 8px;">Liens de session:</h5>
                        
                        <div class="link-demo">
                            <div class="link-icon">‚ñ∂Ô∏è</div>
                            <div style="flex: 1;">
                                <p style="margin: 0; font-size: 14px; font-weight: 500; color: #1e40af;">Enregistrement vid√©o</p>
                                <p style="margin: 0; font-size: 12px; color: #3b82f6;">video</p>
                            </div>
                            <div style="color: #3b82f6;">üîó</div>
                        </div>
                        
                        <div class="link-demo">
                            <div class="link-icon">üìÑ</div>
                            <div style="flex: 1;">
                                <p style="margin: 0; font-size: 14px; font-weight: 500; color: #1e40af;">Support PDF</p>
                                <p style="margin: 0; font-size: 12px; color: #3b82f6;">document</p>
                            </div>
                            <div style="color: #3b82f6;">üîó</div>
                        </div>
                        
                        <div class="link-demo">
                            <div class="link-icon">üìö</div>
                            <div style="flex: 1;">
                                <p style="margin: 0; font-size: 14px; font-weight: 500; color: #1e40af;">Ressources compl√©mentaires</p>
                                <p style="margin: 0; font-size: 12px; color: #3b82f6;">resource</p>
                            </div>
                            <div style="color: #3b82f6;">üîó</div>
                        </div>
                    </div>
                    
                    <div style="margin-top: 12px; display: flex; justify-content: between; align-items: center;">
                        <div style="display: flex; align-items: center; gap: 8px;">
                            <span style="color: #10b981;">‚úÖ</span>
                            <span style="font-size: 14px; color: #10b981;">Session termin√©e</span>
                        </div>
                    </div>
                </div>
            </div>
        </div>

        <div class="section">
            <h2>üß™ Tests √† Effectuer</h2>
            
            <div class="grid">
                <div class="card">
                    <h3>Test Backend</h3>
                    <ol style="font-size: 14px;">
                        <li>Cr√©er une formation dans Admin Panel</li>
                        <li>Ajouter un cours √† la formation</li>
                        <li>Ajouter des sessions avec liens</li>
                        <li>V√©rifier sauvegarde en base</li>
                    </ol>
                    <button class="test-button" onclick="testBackendData()">Tester Backend</button>
                    <div id="backend-result" class="result"></div>
                </div>
                
                <div class="card">
                    <h3>Test Frontend</h3>
                    <ol style="font-size: 14px;">
                        <li>Se connecter √† l'Espace Participant</li>
                        <li>Aller dans "Mes Formations"</li>
                        <li>Cliquer sur une formation</li>
                        <li>Cliquer sur un cours</li>
                        <li>V√©rifier section "Sessions du cours"</li>
                    </ol>
                    <button class="test-button" onclick="testFrontendDisplay()">Tester Frontend</button>
                    <div id="frontend-result" class="result"></div>
                </div>
            </div>
        </div>

        <div class="section">
            <h2>üìä Structure de Donn√©es</h2>
            
            <div class="info">
                <h3>Format Backend (MongoDB)</h3>
                <pre style="font-size: 11px;">{
  "participantId": "PART-2024-001",
  "title": "Formation D√©veloppement Web",
  "courses": [
    {
      "id": "course-1",
      "title": "Introduction",
      "sessions": [
        {
          "id": "session-1",
          "title": "Session 1: Bases",
          "description": "Introduction aux concepts",
          "duration": "2h30",
          "isCompleted": false,
          "links": [
            {
              "id": "link-1",
              "title": "Enregistrement vid√©o",
              "url": "https://example.com/video",
              "type": "video"
            },
            {
              "id": "link-2", 
              "title": "Support PDF",
              "url": "https://example.com/pdf",
              "type": "document"
            }
          ]
        }
      ]
    }
  ]
}</pre>
            </div>
        </div>

        <div class="section">
            <h2>‚úÖ R√©sultat Attendu</h2>
            
            <div class="success">
                <h3>üéØ Fonctionnalit√©s Ajout√©es</h3>
                <ul>
                    <li>‚úÖ Section "Sessions du cours" visible</li>
                    <li>‚úÖ Liens de session cliquables</li>
                    <li>‚úÖ Ic√¥nes par type de lien (vid√©o, document, etc.)</li>
                    <li>‚úÖ Statut de session (termin√©e/en attente)</li>
                    <li>‚úÖ Bouton "Marquer comme termin√©e"</li>
                    <li>‚úÖ Design responsive et moderne</li>
                    <li>‚úÖ Animations Framer Motion</li>
                </ul>
            </div>

            <div class="warning">
                <h3>‚ö†Ô∏è Points d'Attention</h3>
                <ul>
                    <li>Les sessions n'apparaissent que si elles existent dans les donn√©es</li>
                    <li>Les liens s'ouvrent dans un nouvel onglet</li>
                    <li>Le statut des sessions peut √™tre mis √† jour</li>
                    <li>Compatible avec la structure existante</li>
                </ul>
            </div>
        </div>

        <div class="section">
            <h2>üöÄ Pour Tester</h2>
            
            <div class="step">
                <h3>√âtapes de Test</h3>
                <ol>
                    <li><strong>Admin Panel:</strong> Cr√©er formation ‚Üí Ajouter cours ‚Üí Ajouter sessions avec liens</li>
                    <li><strong>Espace Participant:</strong> Se connecter ‚Üí Mes Formations ‚Üí S√©lectionner formation ‚Üí S√©lectionner cours</li>
                    <li><strong>V√©rification:</strong> La section "Sessions du cours" doit appara√Ætre avec les liens</li>
                    <li><strong>Test Liens:</strong> Cliquer sur les liens pour v√©rifier qu'ils s'ouvrent correctement</li>
                </ol>
            </div>
        </div>
    </div>

    <script>
        const API_BASE = 'http://localhost:3001/api';
        
        async function testBackendData() {
            const resultDiv = document.getElementById('backend-result');
            resultDiv.textContent = 'Test en cours...';
            
            try {
                // Test participant formations
                const response = await fetch(`${API_BASE}/participants/PART-2024-001/formations`);
                if (response.ok) {
                    const result = await response.json();
                    console.log('Formations data:', result);
                    
                    if (result.success && result.data.length > 0) {
                        const formation = result.data[0];
                        const hasSessions = formation.courses?.some(course => course.sessions?.length > 0);
                        
                        resultDiv.className = 'result success';
                        resultDiv.innerHTML = `
                            <strong>‚úÖ Backend Test OK</strong><br>
                            Formations: ${result.data.length}<br>
                            Sessions trouv√©es: ${hasSessions ? 'Oui' : 'Non'}<br>
                            <pre>${JSON.stringify(formation.courses?.[0]?.sessions || [], null, 2)}</pre>
                        `;
                    } else {
                        resultDiv.className = 'result warning';
                        resultDiv.innerHTML = '<strong>‚ö†Ô∏è Pas de formations avec sessions</strong>';
                    }
                } else {
                    throw new Error(`HTTP ${response.status}`);
                }
            } catch (error) {
                resultDiv.className = 'result error';
                resultDiv.innerHTML = `<strong>‚ùå Erreur Backend</strong><br>${error.message}`;
            }
        }
        
        async function testFrontendDisplay() {
            const resultDiv = document.getElementById('frontend-result');
            resultDiv.className = 'result info';
            resultDiv.innerHTML = `
                <strong>üìã Instructions Frontend</strong><br>
                1. Aller sur localhost:5173/espace-participant<br>
                2. Se connecter avec PART-2024-001<br>
                3. Cliquer sur "Mes Formations"<br>
                4. S√©lectionner une formation<br>
                5. S√©lectionner un cours<br>
                6. V√©rifier la section "Sessions du cours"<br><br>
                <strong>‚úÖ Si les sessions apparaissent ‚Üí Test r√©ussi</strong><br>
                <strong>‚ùå Si pas de sessions ‚Üí V√©rifier donn√©es backend</strong>
            `;
        }
        
        // Auto-run backend test on page load
        window.onload = function() {
            console.log('üß™ Test Sessions Links - Page charg√©e');
        };
    </script>
</body>
</html>
