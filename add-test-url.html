<!DOCTYPE html>
<html lang="ar" dir="rtl">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Ø¥Ø¶Ø§ÙØ© Ø±Ø§Ø¨Ø· Ø§Ø®ØªØ¨Ø§Ø±</title>
    <style>
        body { font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, sans-serif; margin: 0; padding: 20px; background: #f5f7fa; }
        .container { max-width: 800px; margin: 0 auto; background: white; border-radius: 12px; box-shadow: 0 4px 6px rgba(0,0,0,0.1); overflow: hidden; }
        .header { background: linear-gradient(135deg, #3b82f6 0%, #1d4ed8 100%); color: white; padding: 30px; text-align: center; }
        .section { padding: 20px; }
        .test-button { background: #3b82f6; color: white; border: none; padding: 12px 24px; border-radius: 8px; cursor: pointer; margin: 10px 0; font-weight: 500; display: block; width: 100%; }
        .test-button:hover { background: #1d4ed8; }
        .test-button.success { background: #10b981; }
        .result { background: #f7fafc; border: 1px solid #e2e8f0; border-radius: 8px; padding: 15px; margin: 10px 0; font-family: monospace; font-size: 12px; }
        .result.success { background: #ecfdf5; border-color: #10b981; color: #065f46; }
        .result.error { background: #fef2f2; border-color: #ef4444; color: #991b1b; }
    </style>
</head>
<body>
    <div class="container">
        <div class="header">
            <h1>ğŸ”— Ø¥Ø¶Ø§ÙØ© Ø±Ø§Ø¨Ø· Ø§Ø®ØªØ¨Ø§Ø±</h1>
            <p>Ø¥Ø¶Ø§ÙØ© Ø±Ø§Ø¨Ø· Ù„Ù„Ù…Ø´Ø±ÙˆØ¹ Ù„Ø§Ø®ØªØ¨Ø§Ø± Ø§Ù„Ø¹Ø±Ø¶ Ø§Ù„Ø¬Ø¯ÙŠØ¯</p>
        </div>

        <div class="section">
            <h2>ğŸ¯ Ø§Ù„Ù‡Ø¯Ù</h2>
            <p>Ø¥Ø¶Ø§ÙØ© Ø±Ø§Ø¨Ø· Ø§Ø®ØªØ¨Ø§Ø± Ù„Ù„Ù…Ø´Ø±ÙˆØ¹ "cima" Ù„Ø±Ø¤ÙŠØ© ÙƒÙŠÙ Ø³ÙŠØ¸Ù‡Ø± ÙÙŠ Ø§Ù„Ø¬Ø¯ÙˆÙ„ Ø§Ù„Ø¬Ø¯ÙŠØ¯</p>
            
            <button class="test-button" onclick="addTestUrl()">ğŸ”— Ø¥Ø¶Ø§ÙØ© Ø±Ø§Ø¨Ø· Ø§Ø®ØªØ¨Ø§Ø± Ù„Ù„Ù…Ø´Ø±ÙˆØ¹</button>
            <div id="result" class="result"></div>
            
            <h3>ğŸ“‹ Ø§Ù„Ø®Ø·ÙˆØ§Øª Ø¨Ø¹Ø¯ Ø§Ù„Ø¥Ø¶Ø§ÙØ©:</h3>
            <ol>
                <li>Ø­Ø¯Ø« ØµÙØ­Ø© Ø§Ù„Ù…Ø´Ø§Ø±Ùƒ (F5)</li>
                <li>Ø§Ø¨Ø­Ø« Ø¹Ù† Ù‚Ø³Ù… "Lien du projet" ÙÙŠ Ø¨Ø·Ø§Ù‚Ø© Ø§Ù„Ù…Ø´Ø±ÙˆØ¹</li>
                <li>ÙŠØ¬Ø¨ Ø£Ù† ØªØ±Ù‰ "Ouvrir le lien" Ø¨Ø¯Ù„Ø§Ù‹ Ù…Ù† "Aucun lien disponible"</li>
                <li>Ø§Ø¶ØºØ· Ø¹Ù„Ù‰ Ø§Ù„Ø±Ø§Ø¨Ø· Ù„Ù„Ø§Ø®ØªØ¨Ø§Ø±</li>
            </ol>
        </div>
    </div>

    <script>
        const API_BASE = 'http://localhost:3001/api';
        const PARTICIPANT_ID = 'PART-177037';
        const TEST_URL = 'https://tv.animerco.org/';

        async function addTestUrl() {
            const resultDiv = document.getElementById('result');
            resultDiv.textContent = 'Ø¥Ø¶Ø§ÙØ© Ø±Ø§Ø¨Ø· Ø§Ø®ØªØ¨Ø§Ø±...';
            
            try {
                console.log('ğŸ”— Ø¥Ø¶Ø§ÙØ© Ø±Ø§Ø¨Ø· Ø§Ø®ØªØ¨Ø§Ø± Ù„Ù„Ù…Ø´Ø±ÙˆØ¹');
                
                // Get current participant data
                const getResponse = await fetch(`${API_BASE}/participants/${PARTICIPANT_ID}`);
                const participantData = await getResponse.json();
                
                if (!participantData.success) {
                    throw new Error('Ø§Ù„Ù…Ø´Ø§Ø±Ùƒ ØºÙŠØ± Ù…ÙˆØ¬ÙˆØ¯');
                }
                
                console.log('ğŸ‘¤ Ø¨ÙŠØ§Ù†Ø§Øª Ø§Ù„Ù…Ø´Ø§Ø±Ùƒ:', participantData.data);
                
                // Update project with test URL
                const updatedProjects = participantData.data.projects.map(project => {
                    if (project.title === 'cima') {
                        console.log(`ğŸ”„ Ø¥Ø¶Ø§ÙØ© Ø±Ø§Ø¨Ø· Ù„Ù„Ù…Ø´Ø±ÙˆØ¹: ${project.title}`);
                        return { ...project, projectUrl: TEST_URL };
                    }
                    return project;
                });
                
                // Send update
                const updateResponse = await fetch(`${API_BASE}/participants/${PARTICIPANT_ID}`, {
                    method: 'PUT',
                    headers: {
                        'Content-Type': 'application/json'
                    },
                    body: JSON.stringify({
                        ...participantData.data,
                        projects: updatedProjects
                    })
                });
                
                const updateResult = await updateResponse.json();
                
                if (updateResult.success) {
                    resultDiv.className = 'result success';
                    resultDiv.innerHTML = `
                        <strong>ğŸ‰ ØªÙ… Ø¥Ø¶Ø§ÙØ© Ø§Ù„Ø±Ø§Ø¨Ø· Ø¨Ù†Ø¬Ø§Ø­!</strong><br><br>
                        â€¢ Ø§Ù„Ù…Ø´Ø±ÙˆØ¹: cima<br>
                        â€¢ Ø§Ù„Ø±Ø§Ø¨Ø·: ${TEST_URL}<br>
                        â€¢ Ø§Ù„Ù…Ø´Ø§Ø±Ùƒ: ${PARTICIPANT_ID}<br><br>
                        
                        <strong>âœ… Ø§Ù„Ø¢Ù†:</strong><br>
                        1. Ø­Ø¯Ø« ØµÙØ­Ø© Ø§Ù„Ù…Ø´Ø§Ø±Ùƒ (F5)<br>
                        2. Ø§Ø¨Ø­Ø« Ø¹Ù† Ù‚Ø³Ù… "Lien du projet" ÙÙŠ Ø¨Ø·Ø§Ù‚Ø© Ø§Ù„Ù…Ø´Ø±ÙˆØ¹<br>
                        3. ÙŠØ¬Ø¨ Ø£Ù† ØªØ±Ù‰ Ø²Ø± "Ouvrir le lien" Ø£Ø²Ø±Ù‚<br>
                        4. Ø§Ø¶ØºØ· Ø¹Ù„ÙŠÙ‡ Ù„Ø§Ø®ØªØ¨Ø§Ø± Ø§Ù„Ø±Ø§Ø¨Ø·<br><br>
                        
                        <strong>ğŸ“ Console Log Ø§Ù„Ù…ØªÙˆÙ‚Ø¹:</strong><br>
                        ğŸ”— Ouverture du lien projet depuis le tableau: ${TEST_URL}
                    `;
                } else {
                    throw new Error(updateResult.message || 'ÙØ´Ù„ ÙÙŠ Ø§Ù„ØªØ­Ø¯ÙŠØ«');
                }
                
            } catch (error) {
                console.error('âŒ Ø®Ø·Ø£:', error);
                resultDiv.className = 'result error';
                resultDiv.innerHTML = `
                    <strong>âŒ Ø®Ø·Ø£ ÙÙŠ Ø¥Ø¶Ø§ÙØ© Ø§Ù„Ø±Ø§Ø¨Ø·</strong><br><br>
                    ${error.message}<br><br>
                    <strong>ğŸ› ï¸ ØªØ£ÙƒØ¯ Ù…Ù†:</strong><br>
                    â€¢ Backend ÙŠØ¹Ù…Ù„ Ø¹Ù„Ù‰ localhost:3001<br>
                    â€¢ Ø§Ù„Ù…Ø´Ø§Ø±Ùƒ PART-177037 Ù…ÙˆØ¬ÙˆØ¯<br>
                    â€¢ Ø§Ù„Ù…Ø´Ø±ÙˆØ¹ "cima" Ù…ÙˆØ¬ÙˆØ¯
                `;
            }
        }
    </script>
</body>
</html>
